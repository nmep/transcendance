# Charger les modules nécessaires
module(load="imuxsock")  # Logs des applications locales via syslog
# Augmenter la taille des messages pour éviter le tronquage (défaut = 1024)
$MaxMessageSize 64k

# Envoyer tous les logs vers Logstash en UDP (changer en TCP si nécessaire)
*.* action(type="omfwd"
    target="logstash"
    port="514"
    protocol="udp"
    action.resumeRetryCount="-1"   # Réessayer indéfiniment
    queue.spoolDirectory="/var/spool/rsyslog"
    queue.filename="logstash-queue"
    queue.type="LinkedList"
    queue.size="50000"             # Ajuster selon les besoins
)